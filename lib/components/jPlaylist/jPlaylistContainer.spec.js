"use strict";var _react=_interopRequireDefault(require("react")),_expect=_interopRequireDefault(require("expect")),_proxyquire=_interopRequireDefault(require("proxyquire")),_reactJplayer=require("react-jplayer"),_containerSetup=_interopRequireDefault(require("../../util/specHelpers/containerSetup.spec")),_actions=require("../../actions/actions");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}_proxyquire["default"].noCallThru();var id="TestPlayer",mockJPlaylist=function(){return _react["default"].createElement("div",null)},JPlaylistContainer=(0,_proxyquire["default"])("./jPlaylistContainer",{"./jPlaylist":mockJPlaylist})["default"],setup=function(a,b,c){return(0,_containerSetup["default"])(JPlaylistContainer,a,b,_objectSpread({id:id},c))},media=document.createElement("audio");describe("JPlaylistContainer",function(){var a,b;beforeEach(function(){a=_defineProperty({},id,{src:"test.mp3"}),b=_defineProperty({},id,{current:0,playlist:[{id:"test",sources:{mp3:"test.mp3"}}]}),_expect["default"].spyOn(document,"getElementById").andReturn({getElementsByClassName:_expect["default"].createSpy().andReturn([media])})}),describe("prop updated",function(){describe("changeMedia",function(){it("sets the new media when playlist is not empty",function(){var c=setup(b,a),d=c.store,e=[{id:"newTest",sources:{mp3:"newTest.mp3"}}];d.dispatch((0,_actions.setPlaylist)(id,e));var f=d.getState().jPlayers[id];(0,_expect["default"])(f.media).toContain(e[0])})})}),describe("clearMediaWhenPlaylistEmpty",function(){it("clears the media when playlist is empty",function(){var c=setup(b,a),d=c.store;d.dispatch((0,_actions.setPlaylist)(id,[]));var e=d.getState().jPlayers[id];(0,_expect["default"])(e).toEqual(_objectSpread({},_reactJplayer.constants.defaultStatus,{media:_reactJplayer.constants.defaultOptions.media}))})}),describe("setLoop",function(){it("sets jPlayer loop to false when looping",function(){var c=setup(b,a),d=c.store;d.dispatch((0,_actions.setOption)(id,"loop","off"));var e=d.getState().jPlayers[id];(0,_expect["default"])(e.loop).toBe(!1)}),it("sets jPlayer loop to true when looping",function(){var c=setup(b,a),d=c.store;d.dispatch((0,_actions.setOption)(id,"loop","loop"));var e=d.getState().jPlayers[id];(0,_expect["default"])(e.loop).toBe(!0)})}),describe("playMediaNow",function(){it("plays jPlayer",function(){var c=setup(b,a),d=c.store;d.dispatch((0,_actions.setOption)(id,"playNow",!0));var e=d.getState().jPlayers[id],f=d.getState().jPlaylists[id];(0,_expect["default"])(e.paused).toBe(!1),(0,_expect["default"])(f.playNow).toBe(!1)})}),afterEach(function(){_expect["default"].restoreSpies()})});